<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warzone Loadouts Config</title>
    <style>
        body { background-color: #0e0e10; color: white; font-family: Arial, sans-serif; }
        .loadout-form { margin-bottom: 20px; }
        .loadout-form input, .loadout-form button { display: block; margin: 10px 0; }
        .loadout { margin: 10px 0; padding: 10px; border: 1px solid white; }
        .loadout img { max-width: 100%; height: auto; }
        .perks { display: flex; gap: 10px; }
        .perks img { width: 50px; height: 50px; }
    </style>
</head>
<body>
    <h1>Warzone Loadouts Configuration</h1>
    <div>
        <form id="loadoutForm" class="loadout-form">
            <input type="text" id="primary" placeholder="Primary Weapon" required>
            <input type="text" id="primaryImage" placeholder="Primary Weapon Image URL" required>
            <input type="text" id="secondary" placeholder="Secondary Weapon" required>
            <input type="text" id="secondaryImage" placeholder="Secondary Weapon Image URL" required>
            <input type="text" id="perk1" placeholder="Perk 1 Name" required>
            <input type="text" id="perk1Image" placeholder="Perk 1 Image URL" required>
            <input type="text" id="perk2" placeholder="Perk 2 Name" required>
            <input type="text" id="perk2Image" placeholder="Perk 2 Image URL" required>
            <input type="text" id="perk3" placeholder="Perk 3 Name" required>
            <input type="text" id="perk3Image" placeholder="Perk 3 Image URL" required>
            <button type="submit">Create Loadout</button>
        </form>
    </div>
    <div id="loadouts"></div>
    <script src="https://extension-files.twitch.tv/helper/v1/twitch-ext.min.js"></script>
    <script>
        window.Twitch.ext.onAuthorized(function(auth) {
            fetchLoadouts();

            document.getElementById('loadoutForm').addEventListener('submit', function(event) {
                event.preventDefault();
                const loadout = {
                    primary: document.getElementById('primary').value,
                    primaryImage: document.getElementById('primaryImage').value,
                    secondary: document.getElementById('secondary').value,
                    secondaryImage: document.getElementById('secondaryImage').value,
                    perks: [
                        { name: document.getElementById('perk1').value, image: document.getElementById('perk1Image').value },
                        { name: document.getElementById('perk2').value, image: document.getElementById('perk2Image').value },
                        { name: document.getElementById('perk3').value, image: document.getElementById('perk3Image').value }
                    ]
                };
                fetch('https://your-backend-domain/create_loadout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${auth.token}`
                    },
                    body: JSON.stringify(loadout)
                }).then(response => response.json()).then(() => fetchLoadouts());
            });
        });

        function fetchLoadouts() {
            fetch('https://your-backend-domain/get_loadouts', {
                headers: {
                    'Authorization': `Bearer ${window.Twitch.ext.viewer.opaqueId}`
                }
            })
            .then(response => response.json())
            .then(loadouts => {
                const loadoutsDiv = document.getElementById('loadouts');
                loadoutsDiv.innerHTML = '';
                for (const id in loadouts) {
                    const loadout = loadouts[id];
                    const loadoutDiv = document.createElement('div');
                    loadoutDiv.className = 'loadout';
                    loadoutDiv.innerHTML = `
                        <h3>Loadout ${id}</h3>
                        <p><strong>Primary:</strong></p>
                        <img src="${loadout.primaryImage}" alt="${loadout.primary}">
                        <p><strong>Secondary:</strong></p>
                        <img src="${loadout.secondaryImage}" alt="${loadout.secondary}">
                        <p><strong>Perks:</strong></p>
                        <div class="perks">
                            ${loadout.perks.map(perk => `<img src="${perk.image}" alt="${perk.name}" title="${perk.name}">`).join('')}
                        </div>
                        <button onclick="editLoadout(${id})">Edit</button>
                        <button onclick="deleteLoadout(${id})">Delete</button>
                    `;
                    loadoutsDiv.appendChild(loadoutDiv);
                }
            });
        }

        function editLoadout(id) {
            const loadout = loadouts[id];
            document.getElementById('primary').value = loadout.primary;
            document.getElementById('primaryImage').value = loadout.primaryImage;
            document.getElementById('secondary').value = loadout.secondary;
            document.getElementById('secondaryImage').value = loadout.secondaryImage;
            document.getElementById('perk1').value = loadout.perks[0].name;
            document.getElementById('perk1Image').value = loadout.perks[0].image;
            document.getElementById('perk2').value = loadout.perks[1].name;
            document.getElementById('perk2Image').value = loadout.perks[1].image;
            document.getElementById('perk3').value = loadout.perks[2].name;
            document.getElementById('perk3Image').value = loadout.perks[2].image;

            document.getElementById('loadoutForm').onsubmit = function(event) {
                event.preventDefault();
                const updatedLoadout = {
                    primary: document.getElementById('primary').value,
                    primaryImage: document.getElementById('primaryImage').value,
                    secondary: document.getElementById('secondary').value,
                    secondaryImage: document.getElementById('secondaryImage').value,
                    perks: [
                        { name: document.getElementById('perk1').value, image: document.getElementById('perk1Image').value },
                        { name: document.getElementById('perk2').value, image: document.getElementById('perk2Image').value },
                        { name: document.getElementById('perk3').value, image: document.getElementById('perk3Image').value }
                    ]
                };
                fetch(`https://your-backend-domain/update_loadout/${id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${window.Twitch.ext.viewer.opaqueId}`
                    },
                    body: JSON.stringify(updatedLoadout)
                }).then(response => response.json()).then(() => fetchLoadouts());
            };
        }

        function deleteLoadout(id) {
            fetch(`https://your-backend-domain/delete_loadout/${id}`, {
                method: 'DELETE',
                headers: {
                    'Authorization': `Bearer ${window.Twitch.ext.viewer.opaqueId}`
                }
            }).then(response => response.json()).then(() => fetchLoadouts());
        }
    </script>
</body>
</html>
